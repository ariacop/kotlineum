"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react");function n(){var n=t.useRef(new Map),e={subscribe:function(t,r){return n.current.set(t,r),function(){return e.unsubscribe(t)}},unsubscribe:function(t){n.current.delete(t)},emit:function(t){n.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.current.size}},r=[function(t){return e.emit(t)},function(t){var n="sub-".concat(Math.random());return e.subscribe(n,t)}];return Object.assign(r,e),r}var e=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t){if(!this.flows.has(t)){var n=new Map,e={subscribe:function(t,r){return n.set(t,r),function(){return e.unsubscribe(t)}},unsubscribe:function(t){n.delete(t)},emit:function(t){n.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.size}};this.flows.set(t,e)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function r(t){return e.getInstance().getOrCreate(t)}var u=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t,n){if(!this.flows.has(t)){var e=new Map,r=n,u={getValue:function(){return r},subscribe:function(t,n){return e.set(t,n),n(r),function(){return u.unsubscribe(t)}},unsubscribe:function(t){e.delete(t)},update:function(t){r=t,e.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return e.size}};this.flows.set(t,u)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function c(t,n){return u.getInstance().getOrCreate(t,n)}exports.GlobalSharedFlow=r,exports.GlobalStateFlow=c,exports.SharedFlow=function(){var t={current:new Map},n={subscribe:function(e,r){return t.current.set(e,r),function(){return n.unsubscribe(e)}},unsubscribe:function(n){t.current.delete(n)},emit:function(n){t.current.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return t.current.size}};return n},exports.StateFlow=function(t){var n={current:new Map},e=t,r={getValue:function(){return e},subscribe:function(t,u){return n.current.set(t,u),u(e),function(){return r.unsubscribe(t)}},unsubscribe:function(t){n.current.delete(t)},update:function(t){e=t,n.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.current.size}};return r},exports.useGlobalSharedFlow=function(n,e){var u=r(n);return t.useEffect((function(){var t;return e&&(t=u.subscribe("hook-".concat(n,"-").concat(Math.random()),e)),function(){t&&t()}}),[n,e]),[function(t){return u.emit(t)},function(t){return u.subscribe("sub-".concat(n,"-").concat(Math.random()),t)}]},exports.useGlobalSharedFlowWithState=function(n,e){var u=t.useState(e),c=u[0],o=u[1],s=r(n);return t.useEffect((function(){return s.subscribe("state-".concat(n,"-").concat(Math.random()),(function(t){return o(t)}))}),[n]),[c,function(t){return s.emit(t)}]},exports.useGlobalStateFlow=function(n,e){var r=t.useState(e),u=r[0],o=r[1],s=c(n,e);return t.useEffect((function(){var t=s.subscribe("hook-".concat(n,"-").concat(Math.random()),(function(t){o(t)}));return o(s.getValue()),t}),[n,e]),[u,function(t){return s.update(t)}]},exports.useSharedFlow=n,exports.useSharedFlowWithState=function(e){var r=t.useState(e),u=r[0],c=r[1],o=n();return t.useRef((function(){o.subscribe("internal-state",(function(t){return c(t)}))})).current(),[u,o.emit,function(t){return o.subscribe("sub-".concat(Math.random()),t)}]},exports.useStateFlow=function(n){var e=t.useState(n),r=e[0],u=e[1],c=t.useRef(new Map),o={getValue:function(){return r},subscribe:function(t,n){return c.current.set(t,n),n(r),function(){return o.unsubscribe(t)}},unsubscribe:function(t){c.current.delete(t)},update:function(t){u(t),c.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return c.current.size}},s=[r,o.update];return Object.assign(s,o),s};
//# sourceMappingURL=index.js.map
