"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react");function e(){var t={current:new Map},e={subscribe:function(n,r){return t.current.set(n,r),function(){return e.unsubscribe(n)}},unsubscribe:function(e){t.current.delete(e)},emit:function(e){t.current.forEach((function(t){return t(e)}))},getSubscriberCount:function(){return t.current.size}};return e}function n(){var e=t.useRef(new Map),n={subscribe:function(t,r){return e.current.set(t,r),function(){return n.unsubscribe(t)}},unsubscribe:function(t){e.current.delete(t)},emit:function(t){e.current.forEach((function(e){return e(t)}))},getSubscriberCount:function(){return e.current.size}},r=[function(t){return n.emit(t)},function(t){var e="sub-".concat(Math.random());return n.subscribe(e,t)}];return Object.assign(r,n),r}function r(t){var e={current:new Map},n=t,r={getValue:function(){return n},subscribe:function(t,u){return e.current.set(t,u),u(n),function(){return r.unsubscribe(t)}},unsubscribe:function(t){e.current.delete(t)},update:function(t){n=t,e.current.forEach((function(e){return e(t)}))},getSubscriberCount:function(){return e.current.size}};return r}var u=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t){if(!this.flows.has(t)){var e=new Map,n={subscribe:function(t,r){return e.set(t,r),function(){return n.unsubscribe(t)}},unsubscribe:function(t){e.delete(t)},emit:function(t){e.forEach((function(e){return e(t)}))},getSubscriberCount:function(){return e.size}};this.flows.set(t,n)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function o(t){return u.getInstance().getOrCreate(t)}var s=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t,e){if(!this.flows.has(t)){var n=new Map,r=e,u={getValue:function(){return r},subscribe:function(t,e){return n.set(t,e),e(r),function(){return u.unsubscribe(t)}},unsubscribe:function(t){n.delete(t)},update:function(t){r=t,n.forEach((function(e){return e(t)}))},getSubscriberCount:function(){return n.size}};this.flows.set(t,u)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function i(t,e){return s.getInstance().getOrCreate(t,e)}var c=function(){return c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var u in e=arguments[n])Object.prototype.hasOwnProperty.call(e,u)&&(t[u]=e[u]);return t},c.apply(this,arguments)};function a(t,e,n){if(n||2===arguments.length)for(var r,u=0,o=e.length;u<o;u++)!r&&u in e||(r||(r=Array.prototype.slice.call(e,0,u)),r[u]=e[u]);return t.concat(r||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var f=function(){function t(t){this.isDisposed=!1,this.stateFlow=r({data:t,loading:!1,error:null}),this.eventsFlow=e()}return t.prototype.getState=function(){return this.stateFlow.getValue()},t.prototype.getData=function(){return this.stateFlow.getValue().data},t.prototype.subscribeToState=function(t,e){return this.stateFlow.subscribe(t,e)},t.prototype.subscribeToEvents=function(t,e){return this.eventsFlow.subscribe(t,e)},t.prototype.setLoading=function(t){this.stateFlow.update(c(c({},this.stateFlow.getValue()),{loading:t}))},t.prototype.setError=function(t){this.stateFlow.update(c(c({},this.stateFlow.getValue()),{error:t}))},t.prototype.updateData=function(t){this.stateFlow.update(c(c({},this.stateFlow.getValue()),{data:t}))},t.prototype.updateState=function(t){this.stateFlow.update(c(c({},this.stateFlow.getValue()),t))},t.prototype.emitEvent=function(t){this.eventsFlow.emit(t)},t.prototype.dispose=function(){this.isDisposed||(this.onDispose(),this.isDisposed=!0)},t.prototype.onDispose=function(){},t}(),l=function(){function t(){this.viewModels=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.get=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!this.viewModels.has(t)){var u=new(e.bind.apply(e,a([void 0],n,!1)));return this.viewModels.set(t,u),u}return this.viewModels.get(t)},t.prototype.has=function(t){return this.viewModels.has(t)},t.prototype.remove=function(t){if(this.viewModels.has(t)){var e=this.viewModels.get(t);null==e||e.dispose(),this.viewModels.delete(t)}},t.prototype.clear=function(){this.viewModels.forEach((function(t){return t.dispose()})),this.viewModels.clear()},t}();function p(e,n){for(var r=[],u=2;u<arguments.length;u++)r[u-2]=arguments[u];var o=l.getInstance(),s=o.get.apply(o,a([e,n],r,!1)),i=t.useState(s.getState()),c=i[0],f=i[1],p=t.useRef("vm-".concat(e,"-").concat(Math.random()));return t.useEffect((function(){var t=s.subscribeToState(p.current,f);return function(){t()}}),[s]),[c,s]}exports.GlobalSharedFlow=o,exports.GlobalStateFlow=i,exports.SharedFlow=e,exports.StateFlow=r,exports.ViewModel=f,exports.ViewModelProvider=l,exports.useGlobalSharedFlow=function(e,n){var r=o(e);return t.useEffect((function(){var t;return n&&(t=r.subscribe("hook-".concat(e,"-").concat(Math.random()),n)),function(){t&&t()}}),[e,n]),[function(t){return r.emit(t)},function(t){return r.subscribe("sub-".concat(e,"-").concat(Math.random()),t)}]},exports.useGlobalSharedFlowWithState=function(e,n){var r=t.useState(n),u=r[0],s=r[1],i=o(e);return t.useEffect((function(){return i.subscribe("state-".concat(e,"-").concat(Math.random()),(function(t){return s(t)}))}),[e]),[u,function(t){return i.emit(t)}]},exports.useGlobalStateFlow=function(e,n){var r=t.useState(n),u=r[0],o=r[1],s=i(e,n);return t.useEffect((function(){var t=s.subscribe("hook-".concat(e,"-").concat(Math.random()),(function(t){o(t)}));return o(s.getValue()),t}),[e,n]),[u,function(t){return s.update(t)}]},exports.useGlobalViewModel=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var u="global-".concat(t);return p.apply(void 0,a([u,e],n,!1))},exports.useSharedFlow=n,exports.useSharedFlowWithState=function(e){var r=t.useState(e),u=r[0],o=r[1],s=n();return t.useRef((function(){s.subscribe("internal-state",(function(t){return o(t)}))})).current(),[u,s.emit,function(t){return s.subscribe("sub-".concat(Math.random()),t)}]},exports.useStateFlow=function(e){var n=t.useState(e),r=n[0],u=n[1],o=t.useRef(new Map),s={getValue:function(){return r},subscribe:function(t,e){return o.current.set(t,e),e(r),function(){return s.unsubscribe(t)}},unsubscribe:function(t){o.current.delete(t)},update:function(t){u(t),o.current.forEach((function(e){return e(t)}))},getSubscriberCount:function(){return o.current.size}},i=[r,s.update];return Object.assign(i,s),i},exports.useViewModel=p;
//# sourceMappingURL=index.js.map
