import{useRef as n,useState as t,useEffect as r}from"react";function e(){var n={current:new Map},t={subscribe:function(r,e){return n.current.set(r,e),function(){return t.unsubscribe(r)}},unsubscribe:function(t){n.current.delete(t)},emit:function(t){n.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.current.size}};return t}function u(){var t=n(new Map),r={subscribe:function(n,e){return t.current.set(n,e),function(){return r.unsubscribe(n)}},unsubscribe:function(n){t.current.delete(n)},emit:function(n){t.current.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return t.current.size}},e=[function(n){return r.emit(n)},function(n){var t="sub-".concat(Math.random());return r.subscribe(t,n)}];return Object.assign(e,r),e}function c(r){var e=t(r),c=e[0],i=e[1],o=u();return n((function(){o.subscribe("internal-state",(function(n){return i(n)}))})).current(),[c,o.emit,function(n){return o.subscribe("sub-".concat(Math.random()),n)}]}function i(n){var t={current:new Map},r=n,e={getValue:function(){return r},subscribe:function(n,u){return t.current.set(n,u),u(r),function(){return e.unsubscribe(n)}},unsubscribe:function(n){t.current.delete(n)},update:function(n){r=n,t.current.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return t.current.size}};return e}function o(r){var e=t(r),u=e[0],c=e[1],i=n(new Map),o={getValue:function(){return u},subscribe:function(n,t){return i.current.set(n,t),t(u),function(){return o.unsubscribe(n)}},unsubscribe:function(n){i.current.delete(n)},update:function(n){c(n),i.current.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return i.current.size}},s=[u,o.update];return Object.assign(s,o),s}var s=function(){function n(){this.flows=new Map}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.getOrCreate=function(n){if(!this.flows.has(n)){var t=new Map,r={subscribe:function(n,e){return t.set(n,e),function(){return r.unsubscribe(n)}},unsubscribe:function(n){t.delete(n)},emit:function(n){t.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return t.size}};this.flows.set(n,r)}return this.flows.get(n)},n.prototype.get=function(n){return this.flows.get(n)},n.prototype.has=function(n){return this.flows.has(n)},n}();function f(n){return s.getInstance().getOrCreate(n)}function a(n,t){var e=f(n);r((function(){var r;return t&&(r=e.subscribe("hook-".concat(n,"-").concat(Math.random()),t)),function(){r&&r()}}),[n,t]);return[function(n){return e.emit(n)},function(t){return e.subscribe("sub-".concat(n,"-").concat(Math.random()),t)}]}function b(n,e){var u=t(e),c=u[0],i=u[1],o=f(n);return r((function(){return o.subscribe("state-".concat(n,"-").concat(Math.random()),(function(n){return i(n)}))}),[n]),[c,function(n){return o.emit(n)}]}var h=function(){function n(){this.flows=new Map}return n.getInstance=function(){return n.instance||(n.instance=new n),n.instance},n.prototype.getOrCreate=function(n,t){if(!this.flows.has(n)){var r=new Map,e=t,u={getValue:function(){return e},subscribe:function(n,t){return r.set(n,t),t(e),function(){return u.unsubscribe(n)}},unsubscribe:function(n){r.delete(n)},update:function(n){e=n,r.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return r.size}};this.flows.set(n,u)}return this.flows.get(n)},n.prototype.get=function(n){return this.flows.get(n)},n.prototype.has=function(n){return this.flows.has(n)},n}();function p(n,t){return h.getInstance().getOrCreate(n,t)}function g(n,e){var u=t(e),c=u[0],i=u[1],o=p(n,e);return r((function(){var t=o.subscribe("hook-".concat(n,"-").concat(Math.random()),(function(n){i(n)}));return i(o.getValue()),t}),[n,e]),[c,function(n){return o.update(n)}]}export{f as GlobalSharedFlow,p as GlobalStateFlow,e as SharedFlow,i as StateFlow,a as useGlobalSharedFlow,b as useGlobalSharedFlowWithState,g as useGlobalStateFlow,u as useSharedFlow,c as useSharedFlowWithState,o as useStateFlow};
//# sourceMappingURL=index.esm.js.map
