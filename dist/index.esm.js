import{useRef as t,useState as n,useEffect as e}from"react";function r(){var t={current:new Map},n={subscribe:function(e,r){return t.current.set(e,r),function(){return n.unsubscribe(e)}},unsubscribe:function(n){t.current.delete(n)},emit:function(n){t.current.forEach((function(t){return t(n)}))},getSubscriberCount:function(){return t.current.size}};return n}function u(){var n=t(new Map),e={subscribe:function(t,r){return n.current.set(t,r),function(){return e.unsubscribe(t)}},unsubscribe:function(t){n.current.delete(t)},emit:function(t){n.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.current.size}},r=[function(t){return e.emit(t)},function(t){var n="sub-".concat(Math.random());return e.subscribe(n,t)}];return Object.assign(r,e),r}function o(e){var r=n(e),o=r[0],i=r[1],s=u();return t((function(){s.subscribe("internal-state",(function(t){return i(t)}))})).current(),[o,s.emit,function(t){return s.subscribe("sub-".concat(Math.random()),t)}]}function i(t){var n={current:new Map},e=t,r={getValue:function(){return e},subscribe:function(t,u){return n.current.set(t,u),u(e),function(){return r.unsubscribe(t)}},unsubscribe:function(t){n.current.delete(t)},update:function(t){e=t,n.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.current.size}};return r}function s(e){var r=n(e),u=r[0],o=r[1],i=t(new Map),s={getValue:function(){return u},subscribe:function(t,n){return i.current.set(t,n),n(u),function(){return s.unsubscribe(t)}},unsubscribe:function(t){i.current.delete(t)},update:function(t){o(t),i.current.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return i.current.size}},c=[u,s.update];return Object.assign(c,s),c}var c=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t){if(!this.flows.has(t)){var n=new Map,e={subscribe:function(t,r){return n.set(t,r),function(){return e.unsubscribe(t)}},unsubscribe:function(t){n.delete(t)},emit:function(t){n.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return n.size}};this.flows.set(t,e)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function a(t){return c.getInstance().getOrCreate(t)}function f(t,n){var r=a(t);e((function(){var e;return n&&(e=r.subscribe("hook-".concat(t,"-").concat(Math.random()),n)),function(){e&&e()}}),[t,n]);return[function(t){return r.emit(t)},function(n){return r.subscribe("sub-".concat(t,"-").concat(Math.random()),n)}]}function p(t,r){var u=n(r),o=u[0],i=u[1],s=a(t);return e((function(){return s.subscribe("state-".concat(t,"-").concat(Math.random()),(function(t){return i(t)}))}),[t]),[o,function(t){return s.emit(t)}]}var l=function(){function t(){this.flows=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.getOrCreate=function(t,n){if(!this.flows.has(t)){var e=new Map,r=n,u={getValue:function(){return r},subscribe:function(t,n){return e.set(t,n),n(r),function(){return u.unsubscribe(t)}},unsubscribe:function(t){e.delete(t)},update:function(t){r=t,e.forEach((function(n){return n(t)}))},getSubscriberCount:function(){return e.size}};this.flows.set(t,u)}return this.flows.get(t)},t.prototype.get=function(t){return this.flows.get(t)},t.prototype.has=function(t){return this.flows.has(t)},t}();function b(t,n){return l.getInstance().getOrCreate(t,n)}function h(t,r){var u=n(r),o=u[0],i=u[1],s=b(t,r);return e((function(){var n=s.subscribe("hook-".concat(t,"-").concat(Math.random()),(function(t){i(t)}));return i(s.getValue()),n}),[t,r]),[o,function(t){return s.update(t)}]}var d=function(){return d=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var u in n=arguments[e])Object.prototype.hasOwnProperty.call(n,u)&&(t[u]=n[u]);return t},d.apply(this,arguments)};function g(t,n,e){if(e||2===arguments.length)for(var r,u=0,o=n.length;u<o;u++)!r&&u in n||(r||(r=Array.prototype.slice.call(n,0,u)),r[u]=n[u]);return t.concat(r||Array.prototype.slice.call(n))}"function"==typeof SuppressedError&&SuppressedError;var w=function(){function t(t){this.isDisposed=!1,this.stateFlow=i({data:t,loading:!1,error:null}),this.eventsFlow=r()}return t.prototype.getState=function(){return this.stateFlow.getValue()},t.prototype.getData=function(){return this.stateFlow.getValue().data},t.prototype.subscribeToState=function(t,n){return this.stateFlow.subscribe(t,n)},t.prototype.subscribeToEvents=function(t,n){return this.eventsFlow.subscribe(t,n)},t.prototype.setLoading=function(t){this.stateFlow.update(d(d({},this.stateFlow.getValue()),{loading:t}))},t.prototype.setError=function(t){this.stateFlow.update(d(d({},this.stateFlow.getValue()),{error:t}))},t.prototype.updateData=function(t){this.stateFlow.update(d(d({},this.stateFlow.getValue()),{data:t}))},t.prototype.updateState=function(t){this.stateFlow.update(d(d({},this.stateFlow.getValue()),t))},t.prototype.emitEvent=function(t){this.eventsFlow.emit(t)},t.prototype.dispose=function(){this.isDisposed||(this.onDispose(),this.isDisposed=!0)},t.prototype.onDispose=function(){},t}(),v=function(){function t(){this.viewModels=new Map}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.get=function(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];if(!this.viewModels.has(t)){var u=new(n.bind.apply(n,g([void 0],e,!1)));return this.viewModels.set(t,u),u}return this.viewModels.get(t)},t.prototype.has=function(t){return this.viewModels.has(t)},t.prototype.remove=function(t){if(this.viewModels.has(t)){var n=this.viewModels.get(t);null==n||n.dispose(),this.viewModels.delete(t)}},t.prototype.clear=function(){this.viewModels.forEach((function(t){return t.dispose()})),this.viewModels.clear()},t}();function y(r,u){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var s=v.getInstance(),c=s.get.apply(s,g([r,u],o,!1)),a=n(c.getState()),f=a[0],p=a[1],l=t("vm-".concat(r,"-").concat(Math.random()));return e((function(){var t=c.subscribeToState(l.current,p);return function(){t()}}),[c]),[f,c]}function M(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var u="global-".concat(t);return y.apply(void 0,g([u,n],e,!1))}export{a as GlobalSharedFlow,b as GlobalStateFlow,r as SharedFlow,i as StateFlow,w as ViewModel,v as ViewModelProvider,f as useGlobalSharedFlow,p as useGlobalSharedFlowWithState,h as useGlobalStateFlow,M as useGlobalViewModel,u as useSharedFlow,o as useSharedFlowWithState,s as useStateFlow,y as useViewModel};
//# sourceMappingURL=index.esm.js.map
